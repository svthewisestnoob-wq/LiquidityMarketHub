<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Liquid Hub | Database Debugger</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.1/firebase-database-compat.js"></script>
</head>
<body class="bg-black text-white p-10 font-mono" x-data="debuggerApp()">

    <h1 class="text-4xl font-black mb-4 text-red-600 italic">SYSTEM OVERRIDE</h1>
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
        <div class="bg-zinc-900 p-8 rounded-3xl border border-red-500/30">
            <h2 class="text-xl mb-6 font-bold uppercase tracking-widest">Debugger Toolbox</h2>
            <div class="space-y-4">
                <button @click="wipeListings" class="w-full bg-red-600 p-6 rounded-2xl font-black hover:bg-red-500 transition-all">
                    WIPE ALL LISTINGS
                </button>
                <button @click="wipeEverything" class="w-full border-2 border-red-600 text-red-600 p-6 rounded-2xl font-black hover:bg-red-600 hover:text-white transition-all">
                    DATABASE RESET (NUCLEAR)
                </button>
                <p class="text-[10px] text-zinc-500 mt-4">This will clear every entry in your Firebase database to fix path errors from previous versions.</p>
            </div>
        </div>

        <div class="bg-zinc-900 p-8 rounded-3xl border border-blue-500/30">
            <h2 class="text-xl mb-6 font-bold uppercase tracking-widest text-blue-500">Live JSON Tree</h2>
            <pre class="text-[10px] bg-black p-4 rounded-xl h-64 overflow-auto" x-text="JSON.stringify(rawSnapshot, null, 2)"></pre>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDKCh3sZW596W6vWEdSz_Ecbii0rWJVB-o",
            databaseURL: "https://liquidmarkethub-default-rtdb.firebaseio.com",
            projectId: "liquidmarkethub"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function debuggerApp() {
            return {
                rawSnapshot: {},
                init() {
                    // Listen to the ROOT of the database to see everything
                    db.ref('/').on('value', s => {
                        this.rawSnapshot = s.val() || { message: "Database is empty" };
                    });
                },
                wipeListings() {
                    if(confirm("Delete all listings?")) {
                        db.ref('listings').remove().then(() => alert("Listings Cleared"));
                    }
                },
                wipeEverything() {
                    if(confirm("DANGER: This wipes the ENTIRE database (chats, messages, and listings). Proceed?")) {
                        db.ref('/').remove().then(() => {
                            alert("Database Purged Successfully.");
                            location.reload();
                        });
                    }
                }
            }
        }
    </script>
</body>
</html>